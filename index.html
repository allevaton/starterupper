<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Setup</title>
  <link rel="stylesheet" media="all" href="reset.css" />
  <link rel="stylesheet" media="all" href="text.css" />
  <link rel="stylesheet" media="all" href="960.css" />
  <script src='http://cdn.ractivejs.org/latest/ractive-legacy.min.js'></script>
  <script src='sparkMD5.js'></script>
</head>
<body>
  <article>
    <div id="gravatar_container"></div>
    <script id="gravatar_template" type="text/ractive">
      <header class="container_12">
        <hgroup class="grid_4 prefix_2">
          <h1>{{repo}} Setup</h1>
        </hgroup>
        <div class="clear"></div>
        <div class="grid_9">
          Configure your profile, create a Github account, private repository.
        </div>
      </header>
      <section class="container_12">
        <hgroup class="grid_12">
          <h1>My Profile<hr></h1>
        </hgroup>
        <div class="clear"></div>
        <div class="grid_2"><img src="http://www.gravatar.com/avatar/{{emailHash}}?d=retro&s=120" title="Gravatar for {{email}}" width="120" height="120" /></div>
        <div class="grid_4">
          <form>
            <select on-change="gravatar">
              <option selected>I do not have a Gravatar account</option>
              <option>I have a Gravatar account</option>
            </select><br/>
          </form>
          <ol>
            {{#if gravatarUser}}
              <li><a href="https://en.gravatar.com/emails/new" target="actionRequired">Add {{email}} to Gravatar</a></li>
            {{else}}
              <li><a href="https://en.gravatar.com/connect/?source=_signup" target="actionRequired">Join Gravatar</a> (use {{email}})</li>
            {{/if}}
            <li>Gravatar will email a link. Click to verify email.</li>
            <li><a href="https://en.gravatar.com/gravatars/new" target="actionRequired">Add an image</a>.</li>
          </ol>
        </div>
        <div class="grid_3">
          <form>
            <input type="text" name="user.name" value="{{fullName}}" placeholder="Full name" pattern="[a-zA-Z.]+ [a-zA-Z. ]+" required /><br />
            <input type="email" name="user.email" value="{{email}}" placeholder="School email address" required /><br />
            <input type="text" name="user.school" value="{{school}}" placeholder="School name" pattern="[a-zA-Z. ]+" required />
            <input type="submit" value="Save settings" />
          </form>
        </div>
      </section>
      <br />
      <section class="container_12">
        <hgroup class="grid_9">
          <h1>Github<hr></h1>
        </hgroup>
        <div class="clear"></div>
        <div class="grid_2"><img src="Github.png" /></div>
        <div class="grid_4">
          <form>
            <select on-change="github">
              <option selected>I do not have a Github account</option>
              <option>I have a Github account</option>
            </select><br/>
            <ol>
            {{#if githubUser}}
              <li><a href="https://github.com/settings/emails" target="actionRequired">Add {{email}} to Github</a></li>
            {{else}}
              <li><a href="https://github.com/join" target="actionRequired">Join Github</a> (use {{email}})</li>
            {{/if}}
              <li>Github will email a link. Click to verify email.</li>
              <li><a href="https://education.github.com" target="actionRequired">Request an individual student discount</a>.</li>
            </ol>
          </form>
        </div>
        <div class="grid_3">
          <form>
            <input type="text" name="github.login" value="$(Host_getUsername 'github')" placeholder="Github username" pattern="^[0-9a-zA-Z][0-9a-zA-Z-]*$" required /><br />
            <input type="password" name="github.password" placeholder="Password" pattern=".{7,}" required /><br />
            <input type="text" name="github.code" placeholder="Authentication code" pattern="[0-9]{6}" />
            <input type="submit" value="Login" />
          </form>
        </div>
      </section>
    </script>
  </article>
  <script>
    var ractive = new Ractive({
      // The `el` option can be a node, an ID, or a CSS selector.
      el: 'gravatar_container',

      // We could pass in a string, but for the sake of convenience
      // we're passing the ID of the <script> tag above.
      template: '#gravatar_template',

      // Here, we're passing in some initial data
      data: {
        email: 'lawrancej@wit.edu',
        emailHash: SparkMD5.hash('lawrancej@wit.edu'),
        fullName: 'Joey Lawrance',
        school: 'Wentworth Institute of Technology',
        gravatarUser: false,
        githubUser: false,
        repo: 'COMP278-2014'
      }
    });
    
    ractive.on({
      gravatar: function () {
        ractive.toggle('gravatarUser');
      },
      github: function () {
        ractive.toggle('githubUser');
      }
    });
    ractive.observe('email', function ( newValue, oldValue ) {
      ractive.set('emailHash', SparkMD5.hash(newValue));
    });
  </script>
</body>
</html>